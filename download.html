<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“š</text></svg>">
    <link rel="stylesheet" href="style.css">
    <title>Download Page</title>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <div class="logo" id="logo">
                    <a href="index.html#home">
                        <span class="logo-icon">ðŸ“š</span>
                        <span class="text">Book Sphere</span>
                    </a>
                </div>
                <div class="nav-links" id="nav-links">
                    <a href="index.html">Home</a>
                    <a href="#featured-books">Books</a>
                    <a href="index.html#categories">Categories</a>
                    <a href="about.html">About</a>
                    <a href="#contactus">Contact</a>
                </div>
                <div class="theme-toggle" id="theme-toggle">
                    ðŸŒ™ <!-- Moon icon for dark theme -->
                </div>
                <div class="menu-toggle" id="menu-toggle">â˜°</div>
                <script>
                    function setupMenuToggle() {
                        const menuToggle = document.getElementById('menu-toggle');
                        const navLinks = document.getElementById('nav-links');
                    
                        if (menuToggle && navLinks) {
                            menuToggle.addEventListener('click', () => {
                                navLinks.classList.toggle('active');
                            });
                        } else {
                            console.error('Menu toggle or nav links element not found!');
                        }
                    }
                    
                    // Call the function on page load
                    document.addEventListener('DOMContentLoaded', () => {
                        setupMenuToggle();
                    });
                </script>
            </nav>
        </div>
    </header>

    <div class="download-book">
        <h2 class="title">Book Title</h2>
        <img src="" alt="Book Cover" class="book-cover">
        <h3 class="quote">BookSphere provides you the free PDF books. Click below to download.</h3>
        <div class="buttons">

        <h2>JOIN OUR WHATSAPP GROUP</h2>
            <div class="whatsapp">
                <a href="https://www.whatsapp.com/channel/0029Vb5vL9LDuMRmc0mNvs3T"><button class="link-btn1"><h3>Whatsapp Channel</h3></button></a>
            </div>

            <h2>Join Our Facebook Group</h2>
            <div class="facebook">
                <a href="https://www.facebook.com/groups/1438827183755412"><button class="link-btn2"><h3>Facebook Group</h3></button></a>
            </div>

            <h2>Click Here to Download PDF</h2>
            <div class="download">
                <button class="link-btn3"><h3>Click Here to Download PDF</h3></button>
            <div class="n-box" style="border: 1px solid; margin-top: 10px;">
                <b><p class="k" style="color: red; padding-top: 5px;">âš  Note:</p></b>
                <p class="note"> The PDF file will open automatically after 10 seconds after clicking.</p>
            </div>
            </div>
        </div>
    </div>

    <div class="categories-wrapper">
        <div class="category active" id="All-Books">All Books</div>
        <div class="categories" id="categories">
            <div class="category" id="French">French</div>
            <div class="category" id="Worksheets">Worksheets</div>
            <div class="category" id="Mystery">Mystery</div>
            <div class="category" id="English">English</div>
            <div class="category" id="German">German</div>
            <div class="category" id="Fiction">Fiction</div>
            <div class="category" id="Teachers">Teachers</div>
            <div class="category" id="Literature">Literature</div>
            <div class="category" id="Vocabulary">Vocabulary</div>
            <div class="category" id="Kids">Kids</div>
            <div class="category" id="Exams">Exams</div>
            <div class="category" id="Spanish">Spanish</div>
            <div class="category" id="Self Help">Self Help</div>
            <div class="category" id="Biography">Biography</div>
            <div class="category" id="Course">Course</div>
            <div class="category" id="Education">Education</div>
        </div>
    </div>
    
    <h2 class="section-title">âœ¨ Featured Books</h2>
    
    <div class="books-grid" id="featured-books">
        <!-- Books will be loaded here from JS -->
    </div>

    <div class="pagination">
        <button id="prev-page">Previous</button>
        <div id="page-numbers"></div>
        <button id="next-page">Next</button>
    </div>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section" id="about">
                    <h3 class="footer-title">About BookSphere</h3>
                    <p>We're passionate about books and connecting readers with their next great read. Our mission is to make book discovery easy and enjoyable.</p>
                </div>
                <div class="footer-section">
                    <h3 class="footer-title" id="contactus">Contact Us</h3>
                    <form id="contact-form" class="contact-form">
                        <input type="text" id="name" placeholder="Your Name" required>
                        <input type="email" id="email" placeholder="Your Email" required>
                        <textarea id="message" placeholder="Your Message" rows="4" required></textarea>
                        <button type="submit">Send Message</button>
                    </form>
                </div>
                <div class="footer-section">
                    <h3 class="footer-title">Quick Links</h3>
                    <ul class="footer-links" id="quick-links">
                        <a href="https://whatsapp.com/channel/0029Vb5vL9LDuMRmc0mNvs3T">Whatsapp</a>
                        <br>
                        <a href="https://www.instagram.com/book.sphere7?igsh=MTVncHp4czA3bzY2Ng==">Instagram</a>
                        <br>
                        <a href="https://www.facebook.com/share/g/1ERrACB9KU/">Facebook</a>
                        <br>
                        <a href="https://www.reddit.com/user/Competitive_Wash_629/?utm_source=share&utm_medium=web3x&utm_name=web3xcss&utm_term=1&utm_content=share_button">Reddit</a>
                        <br>
                        <a href="mailto:books.era786@gmail.com">G-mail</a>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3 class="footer-title">Stay Connected</h3>
                    <p>Subscribe to our newsletter for updates and exclusive offers.</p>
                    <div class="newsletter">
                        <input type="email" placeholder="Your email address">
                        <button>Subscribe</button>
                    </div>
                </div>
            </div>
            <div class="copyright">
                Â© 2025 BookSphere Bookstore. All rights reserved.
            </div>
        </div>
    </footer>

    <script>
        // Function to get URL parameters
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Fetch book data based on the bookId
        async function fetchBookById(bookId) {
            const response = await fetch('books.json');
            const books = await response.json();
            return books.find(book => book.id === parseInt(bookId));
        }

        // Display the selected book
        async function displaySelectedBook() {
            const bookId = getQueryParam('bookId');
            if (!bookId) {
                alert('No book selected. Redirecting to home page.');
                window.location.href = 'index.html';
                return;
            }

            const book = await fetchBookById(bookId);
            if (!book) {
                alert('Book not found. Redirecting to home page.');
                window.location.href = 'index.html';
                return;
            }

            // Update the book details on the page
            document.querySelector('.download-book .title').textContent = book.title;
            document.querySelector('.download-book .book-cover').src = book.cover;
            document.querySelector('.download-book .quote').textContent = `BookSphere provides you the free PDF of "${book.title}". Click below to download.`;

            // Set up the download button
            const downloadButton = document.getElementById('download-button');
            downloadButton.onclick = () => {
                startDownloadTimer(book.downloadLink);
            };
        }

        // Start the download timer
        function startDownloadTimer(downloadLink) {
            // Show a countdown message
            const timerElement = document.createElement('div');
            timerElement.textContent = `Download will start in 10 seconds...`;
            document.querySelector('.buttons').appendChild(timerElement);

            // Start the countdown
            let timer = 10;
            const interval = setInterval(() => {
                timer--;
                timerElement.textContent = `Download will start in ${timer} seconds...`;

                if (timer <= 0) {
                    clearInterval(interval);
                    timerElement.remove();
                    // Start the download after 10 seconds
                    window.open(downloadLink, '_blank');
                }
            }, 1000); // Update every 1 second
        }

        // Call the function on page load
        document.addEventListener('DOMContentLoaded', displaySelectedBook);

        let clickCount = 0;
let isTimerRunning = false; // Flag to check if a timer is already running

function startDownloadTimer(downloadLink) {
    if (isTimerRunning) {
        return; // Exit if a timer is already running
    }

    clickCount++;
    if (clickCount >= 3) {
        showPopup(downloadLink);
        return;
    }

    isTimerRunning = true; // Set the flag to true
    let timer = 10;
    const timerElement = document.createElement('div');
    timerElement.textContent = `Download will start in ${timer} seconds...`;
    document.querySelector('.buttons').appendChild(timerElement);

    const interval = setInterval(() => {
        timer--;
        timerElement.textContent = `Download will start in ${timer} seconds...`;

        if (timer <= 0) {
            clearInterval(interval);
            window.open(downloadLink, '_blank');
            timerElement.remove();
            isTimerRunning = false; // Reset the flag after the timer ends
        }
    }, 1000);
}

function showPopup(downloadLink) {
    const popup = document.createElement('div');
    popup.className = 'popup';
    popup.innerHTML = `
        <div class="popup-content">
            <p>If the download is not started, <a href="${downloadLink}" target="_blank">click here to download</a>.</p>
            <button onclick="closePopup()">Close</button>
        </div>
    `;
    document.body.appendChild(popup);
}

function closePopup() {
    const popup = document.querySelector('.popup');
    if (popup) {
        popup.remove();
    }
}

// Update the download button event listener
document.querySelector('.link-btn3').onclick = () => {
    const bookId = getQueryParam('bookId');
    if (bookId) {
        fetchBookById(bookId).then(book => {
            startDownloadTimer(book.downloadLink);
        });
    }
};
    </script>

    <button id="back-to-top" title="Go to top">â†‘</button>

    <script src="script.js"></script>

</body>
</html>