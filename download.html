<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìö</text></svg>">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <title>Book Sphere</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <div class="logo">
                    <a href="">
                        <span class="logo-icon">üìö</span>
                        <span class="text">Book Sphere</span>
                    </a>
                </div>
                <div class="nav-links" id="nav-links">
                    <a href="#home">Home</a>
                    <a href="#featured-books">Books</a>
                    <a href="#categories">Categories</a>
                    <a href="about.html">About</a>
                    <a href="#contactus">Contact</a>
                </div>
                <div class="theme-toggle" id="theme-toggle">
                    üåô <!-- Moon icon for dark theme -->
                </div>
                <div class="menu-toggle" id="menu-toggle">‚ò∞</div>
            </nav>
        </div>
    </header>

    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h1>Discover Your Next Favorite Book</h1>
                <p>Find the perfect books for every interest and explore our vast collection of bestsellers, new releases, and hidden gems.</p>
                <div class="search-bar">
                    <input type="text" id="search-input" placeholder="Search by title, author or keyword...">
                    <button id="search-button">üîç</button>
                </div>
            </div>
        </div>
    </section>
    <div id="search-message" class="search-message"></div>
    
    <main class="container">
        <div class="categories-wrapper">
            <div class="category active" id="All-Books">All Books</div>
            <div class="categories" id="categories">
                <div class="category" id="French">French</div>
                <div class="category" id="Worksheets">Worksheets</div>
                <div class="category" id="Mystery">Mystery</div>
                <div class="category" id="English">English</div>
                <div class="category" id="German">German</div>
                <div class="category" id="Fiction">Fiction</div>
                <div class="category" id="Kids">Kids</div>
                <div class="category" id="Self Help">Self Help</div>
                <div class="category" id="Biography">Biography</div>
            </div>
        </div>
    </main>

    <h2 class="section-title">üìö Bestsellers</h2>
    <div class="books-grid" id="bestseller-books">
        <!-- Books will be loaded here from JS -->
    </div>

    <h2 class="section-title">‚ú® Featured Books</h2>
    <div class="books-grid" id="featured-books">
        <!-- Books will be loaded here from JS -->
    </div>

    <div class="pagination">
        <button id="prev-page">Previous</button>
        <div id="page-numbers"></div>
        <button id="next-page">Next</button>
    </div>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section" id="about">
                    <h3 class="footer-title">About BookSphere</h3>
                    <p>We're passionate about books and connecting readers with their next great read. Our mission is to make book discovery easy and enjoyable.</p>
                </div>
                <div class="footer-section">
                    <h3 class="footer-title" id="contactus">Contact Us</h3>
                    <form id="contact-form" class="contact-form">
                        <input type="text" id="name" placeholder="Your Name" required>
                        <input type="email" id="email" placeholder="Your Email" required>
                        <textarea id="message" placeholder="Your Message" rows="4" required></textarea>
                        <button type="submit">Send Message</button>
                    </form>
                </div>
                <div class="footer-section">
                    <h3 class="footer-title">Quick Links</h3>
                    <ul class="footer-links" id="quick-links">
                        <a href="https://whatsapp.com/channel/0029Vb5vL9LDuMRmc0mNvs3T">Whatsapp</a>
                        <br>
                        <a href="https://www.instagram.com/book.sphere7?igsh=MTVncHp4czA3bzY2Ng==">Instagram</a>
                        <br>
                        <a href="https://www.facebook.com/share/g/1ERrACB9KU/ ">Facebook</a>
                        <br>
                        <a href="https://www.reddit.com/user/Competitive_Wash_629/?utm_source=share&utm_medium=web3x&utm_name=web3xcss&utm_term=1&utm_content=share_button">Reddit</a>
                        <br>
                        <a href="mailto:books.era786@gmail.com">G-mail</a>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3 class="footer-title">Stay Connected</h3>
                    <p>Subscribe to our newsletter for updates and exclusive offers.</p>
                    <div class="newsletter">
                        <input type="email" placeholder="Your email address">
                        <button>Subscribe</button>
                    </div>
                </div>
            </div>
            <div class="copyright">
                ¬© 2025 BookSphere Bookstore. All rights reserved.
            </div>
        </div>
    </footer>

    <script>
        // Fetch books from books.json
        async function fetchBooks() {
            const response = await fetch('books.json');
            const data = await response.json();
            return data;
        }

        // Display books on page load
        document.addEventListener('DOMContentLoaded', async () => {
            const books = await fetchBooks();
            const bestsellers = books.slice(0, 20); // Example: Use the first 20 books as bestsellers
            displayBooks(books, 'featured-books');
            displayBooks(bestsellers, 'bestseller-books');
            updateCategories();
            setupSearch();
            setupMenuToggle();
        });

        // Display books in a section
        function displayBooks(bookList, sectionId) {
            const booksElement = document.getElementById(sectionId);
            booksElement.innerHTML = '';
            
            bookList.forEach(book => {
                const bookCard = createBookCard(book);
                booksElement.appendChild(bookCard);
            });
        }

        // Create a book card element
        function createBookCard(book) {
            const bookCard = document.createElement('div');
            bookCard.className = 'book-card';
            
            bookCard.innerHTML = `
                <div class="book-cover">
                    <div class="download-cover-btn" title="Download Cover" onclick="downloadCover('${book.cover}', '${book.title}')">
                        ‚¨áÔ∏è
                    </div>
                    <div class="book-cover-image" style="background-image: url('${book.cover}')"></div>
                </div>
                <div class="book-info">
                    <h3 class="book-title">${book.title}</h3>
                    <p class="book-author">by ${book.author}</p>
                    <div class="button-container">
                        <button class="download-btn" onclick="window.open('download.html?bookId=${book.id}', '_blank')">Download</button>
                        <button class="share-btn" onclick="shareBook(${book.id})">‚û•</button>
                        <button class="read-online-btn" onclick="window.open('read.html?bookId=${book.id}', '_blank')">Read online</button>
                    </div>
                </div>
            `;
            
            return bookCard;
        }

        // Redirect to the download page
        function redirectToDownloadPage(bookId) {
            window.location.href = `download.html?bookId=${bookId}`;
        }

        function redirectToReadingPage(bookId) {
            window.location.href = `read.html?bookId=${bookId}`;
        }

        // Share the download page link
        function shareBook(bookId) {
            // Generate the download page link dynamically
            const downloadPageLink = `${window.location.origin}/download.html?bookId=${bookId}`;

            if (navigator.share) {
                // Use the Web Share API if available
                navigator.share({
                    title: 'Check out this book!',
                    url: downloadPageLink,
                })
                .then(() => console.log('Shared successfully'))
                .catch((error) => console.error('Error sharing:', error));
            } else {
                // Fallback: Copy link to clipboard
                navigator.clipboard.writeText(downloadPageLink)
                    .then(() => alert('Link copied to clipboard!'))
                    .catch(() => alert('Failed to copy link.'));
            }
        }

        // Copy link (optional, if needed elsewhere)
        function copyLink(link) {
            navigator.clipboard.writeText(link)
                .then(() => alert('Link copied to clipboard!'))
                .catch(() => alert('Failed to copy link.'));
        }

        function downloadCover(coverUrl, title) {
            fetch(coverUrl)
                .then(response => response.blob())
                .then(blob => {
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${title}.jpg`;
                    a.click();
                    window.URL.revokeObjectURL(url);
                })
                .catch(() => alert('Failed to download cover.'));
        }

        // Handle category filtering
        function updateCategories() {
            const categories = document.querySelectorAll('.category');
            
            categories.forEach(category => {
                category.addEventListener('click', async () => {
                    // Remove active class from all categories
                    categories.forEach(cat => cat.classList.remove('active'));
                    
                    // Add active class to clicked category
                    category.classList.add('active');
                    
                    const selectedCategory = category.textContent;
                    const books = await fetchBooks();
                    filterBooksByCategory(selectedCategory, books);
                });
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            const categories = document.getElementById('categories');
            const categoriesContainer = document.createElement('div');
            categoriesContainer.className = 'categories';

            // Move all child nodes of categories to the container
            while (categories.firstChild) {
                categoriesContainer.appendChild(categories.firstChild);
            }

            // Append the container back to the categories div
            categories.appendChild(categoriesContainer);

            // Duplicate the categories for seamless scrolling
            categoriesContainer.innerHTML += categoriesContainer.innerHTML;
        });

        // Filter books by category
        function filterBooksByCategory(category, books) {
            const filteredBooks = category === 'All Books' 
                ? books 
                : books.filter(book => book.category === category);
            
            const filteredBestsellers = category === 'All Books' 
                ? books.slice(0, 20) 
                : books.filter(book => book.category === category).slice(0, 20);
            
            displayBooks(filteredBooks, 'featured-books');
            displayBooks(filteredBestsellers, 'bestseller-books');
        }

        // Setup search functionality
        function setupSearch() {
            const searchInput = document.getElementById('search-input');
            const searchButton = document.getElementById('search-button');
            const searchMessage = document.getElementById('search-message');

            const performSearch = async () => {
                const query = searchInput.value.trim().toLowerCase();
                const books = await fetchBooks();

                if (query) {
                    const filteredBooks = books.filter(book => 
                        book.title.toLowerCase().includes(query) ||
                        book.author.toLowerCase().includes(query) ||
                        book.id.toString().includes(query) // Search by ID
                    );

                    const filteredBestsellers = books.filter(book => 
                        book.title.toLowerCase().includes(query) ||
                        book.author.toLowerCase().includes(query) ||
                        book.id.toString().includes(query) // Search by ID
                    ).slice(0, 20);

                    displayBooks(filteredBooks, 'featured-books');
                    displayBooks(filteredBestsellers, 'bestseller-books');

                    // Show a message if no results are found
                    if (filteredBooks.length === 0) {
                        searchMessage.textContent = 'No books found matching your search.';
                    } else {
                        searchMessage.textContent = `Found ${filteredBooks.length} book(s) matching your search.`;
                    }
                } else {
                    displayBooks(books, 'featured-books');
                    displayBooks(books.slice(0, 20), 'bestseller-books');
                    searchMessage.textContent = ''; // Clear the message
                }
            };

            // Search on button click
            searchButton.addEventListener('click', performSearch);

            // Search on Enter key press
            searchInput.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                    performSearch();
                }
            });
        }

        // Setup mobile menu toggle
        function setupMenuToggle() {
            const menuToggle = document.getElementById('menu-toggle');
            const navLinks = document.getElementById('nav-links');
            
            menuToggle.addEventListener('click', () => {
                navLinks.classList.toggle('active');
            });
        }

        // Pagination
        let currentPage = 1;
        const booksPerPage = 30; // Number of books to display per page

        async function displayBooksWithPagination() {
            const books = await fetchBooks();
            const totalPages = Math.ceil(books.length / booksPerPage);

            // Display books for the current page
            const startIndex = (currentPage - 1) * booksPerPage;
            const endIndex = startIndex + booksPerPage;
            const booksToDisplay = books.slice(startIndex, endIndex);

            displayBooks(booksToDisplay, 'featured-books');

            // Update pagination buttons
            updatePaginationButtons(totalPages);
        }

        function updatePaginationButtons(totalPages) {
            const pageNumbers = document.getElementById('page-numbers');
            pageNumbers.innerHTML = '';

            for (let i = 1; i <= totalPages; i++) {
                const button = document.createElement('button');
                button.textContent = i;
                button.addEventListener('click', () => {
                    currentPage = i;
                    displayBooksWithPagination();
                });

                if (i === currentPage) {
                    button.classList.add('active');
                }

                pageNumbers.appendChild(button);
            }

            // Enable/disable Previous and Next buttons
            const prevButton = document.getElementById('prev-page');
            const nextButton = document.getElementById('next-page');

            prevButton.disabled = currentPage === 1;
            nextButton.disabled = currentPage === totalPages;

            prevButton.addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    displayBooksWithPagination();
                }
            });

            nextButton.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    displayBooksWithPagination();
                }
            });
        }

        // Call the function on page load
        document.addEventListener('DOMContentLoaded', () => {
            displayBooksWithPagination();
        });

        // Setup contact form
        function setupContactForm() {
            const contactForm = document.getElementById('contact-form');

            contactForm.addEventListener('submit', (event) => {
                event.preventDefault();

                const name = document.getElementById('name').value;
                const email = document.getElementById('email').value;
                const message = document.getElementById('message').value;

                const mailtoLink = `mailto:books.era786@gmail.com?subject=Contact%20Form%20Submission&body=Name:%20${encodeURIComponent(name)}%0AEmail:%20${encodeURIComponent(email)}%0AMessage:%20${encodeURIComponent(message)}`;
                window.location.href = mailtoLink;
            });
        }

        // Call the function on page load
        document.addEventListener('DOMContentLoaded', () => {
            setupContactForm();
        });

        // Function to toggle between light and dark themes
        function setupThemeToggle() {
            const themeToggle = document.getElementById('theme-toggle');
            const body = document.body;

            // Check user's preferred theme from localStorage
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                body.classList.add(savedTheme);
                updateThemeIcon(savedTheme);
            }

            themeToggle.addEventListener('click', () => {
                body.classList.toggle('dark-theme');
                const isDarkTheme = body.classList.contains('dark-theme');
                localStorage.setItem('theme', isDarkTheme ? 'dark-theme' : 'light-theme');
                updateThemeIcon(isDarkTheme ? 'dark-theme' : 'light-theme');
            });
        }

        // Function to update the theme icon
        function updateThemeIcon(theme) {
            const themeToggle = document.getElementById('theme-toggle');
            themeToggle.textContent = theme === 'dark-theme' ? '‚òÄÔ∏è' : 'üåô';
        }

        // Call the function on page load
        document.addEventListener('DOMContentLoaded', () => {
            setupThemeToggle();
        });
    </script>
</body>
</html>
